<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>AA Master Mind</title>
    <meta name="theme-color" content="#c8c1b2" />
    <link rel="manifest" href="./manifest.json" />
    <link rel="apple-touch-icon" href="./icons/icon-192.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body>
    <main class="app-shell">
      <section class="board" aria-label="Mastermind travel board">
        <header class="board-top">
          <p class="molded-label" aria-hidden="true">AA Master Mind</p>
          <h1>Mastermind</h1>
          <p class="subtitle" id="subtitle">Select a mode to begin.</p>
          <div class="header-tools">
            <p class="timer-readout" id="timer-readout">TIME 00:00.0</p>
            <button id="sfx-toggle" class="sfx-toggle" type="button">SFX: ON</button>
          </div>
        </header>

        <section class="flow-screen" id="start-screen">
          <h2>Choose Mode</h2>
          <div class="action-stack">
            <button id="solo-mode-btn" type="button">SOLO</button>
            <button id="daily-mode-btn" type="button">DAILY</button>
            <button id="two-player-mode-btn" type="button">TWO PLAYERS</button>
            <button id="match-mode-btn" type="button">MATCH CODE</button>
            <button id="how-to-btn" type="button">HOW TO PLAY</button>
          </div>
        </section>

        <section class="flow-screen hidden" id="howto-screen">
          <button class="back-btn" data-back-home type="button">← Back</button>
          <h2>How to Play</h2>
          <p class="hint">Goal: guess the hidden 4-color code in 6 turns.</p>
          <p class="hint">Duplicates are allowed.</p>
          <p class="hint">Black peg = correct color + correct position.</p>
          <p class="hint">White peg = correct color in wrong position.</p>
        </section>

        <section class="flow-screen hidden" id="daily-locked-screen">
          <button class="back-btn" data-back-home type="button">← Back</button>
          <h2>Daily already played today.</h2>
          <p class="hint" id="daily-locked-summary"></p>
          <div class="action-stack">
            <button id="daily-practice-btn" type="button">Practice Daily (no score)</button>
          </div>
        </section>

        <section class="flow-screen hidden" id="two-player-set-screen">
          <button class="back-btn" data-back-home type="button">← Back</button>
          <h2>Player 1: Set the secret code</h2>
          <p class="hint">Pick 4 colors. Duplicates are allowed.</p>
          <div class="setup-row" id="setup-row" aria-label="Secret setup row"></div>
          <div class="palette" id="setup-palette" role="group" aria-label="Setup palette"></div>
          <div class="action-stack horizontal">
            <button id="setup-clear-btn" type="button">Clear</button>
            <button id="setup-confirm-btn" type="button" disabled>Confirm Code</button>
          </div>
        </section>

        <section class="flow-screen hidden" id="two-player-pass-screen">
          <button class="back-btn" data-back-home type="button">← Back</button>
          <h2>Pass device to Player 2</h2>
          <p class="hint">The code is hidden. Player 2 can now start guessing.</p>
          <div class="action-stack">
            <button id="start-guessing-btn" type="button">Start Guessing</button>
          </div>
        </section>

        <section class="flow-screen hidden" id="match-choice-screen">
          <button class="back-btn" data-back-home type="button">← Back</button>
          <h2>Match Code</h2>
          <p class="hint">Use one-time match codes for fair offline play.</p>
          <div class="action-stack">
            <button id="create-match-btn" type="button">Create Match Code</button>
            <button id="join-match-btn" type="button">Join Match</button>
          </div>
        </section>

        <section class="flow-screen hidden" id="match-create-screen">
          <button class="back-btn" data-back-home type="button">← Back</button>
          <h2>One-time Match Code</h2>
          <p class="hint">Send this code to the other player. Use a fresh code each match.</p>
          <p class="match-code" id="generated-match-code">AA-0000-00</p>
          <div class="action-stack horizontal tri">
            <button id="copy-match-code-btn" type="button">Copy</button>
            <button id="share-match-code-btn" type="button">Share</button>
            <button id="start-created-match-btn" type="button">Start Match</button>
          </div>
        </section>

        <section class="flow-screen hidden" id="match-join-screen">
          <button class="back-btn" data-back-home type="button">← Back</button>
          <h2>Join Match</h2>
          <p class="hint">Type or paste code; it will auto-format.</p>
          <label class="sr-only" for="join-match-input">Match code</label>
          <input id="join-match-input" class="match-input" placeholder="KJ-W6TE-FR" maxlength="11" />
          <p class="error-message" id="join-error"></p>
          <div class="action-stack horizontal">
            <button id="start-joined-match-btn" type="button">Start Match</button>
          </div>
        </section>

        <section class="game-screen hidden" id="game-screen">
          <button class="back-btn" data-back-home type="button">← Back</button>
          <div class="secret-panel" id="secret-panel" aria-label="Secret code panel"></div>
          <section class="rows" id="rows" aria-label="Guess rows"></section>
          <section class="controls" aria-label="Game controls">
            <div class="palette" id="palette" role="group" aria-label="Color palette"></div>
            <div class="action-buttons">
              <button id="undo-btn" type="button">Undo</button>
              <button id="clear-btn" type="button">Clear Row</button>
              <button id="submit-btn" type="button" disabled>Submit Guess</button>
            </div>
          </section>
        </section>

        <section class="stats" aria-live="polite">
          <button class="stats-toggle" id="stats-toggle" type="button">Stats ▾</button>
          <div class="stats-body hidden" id="stats-body">
            <p id="stats-mode">Mode: --</p>
            <p id="stats-played">Played: 0</p>
            <p id="stats-wins">Wins: 0</p>
            <p id="stats-best">Best Score: --</p>
            <p id="stats-best-time">Best Time: --</p>
          </div>
        </section>
      </section>
    </main>

    <section
      class="result-modal hidden"
      id="result-modal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="result-title"
    >
      <div class="result-card">
        <h2 id="result-title">Game Over</h2>
        <p id="result-message"></p>
        <p id="result-time"></p>
        <p id="result-match-code" class="hidden"></p>
        <button id="copy-result-code-btn" type="button" class="hidden">Copy Code</button>
        <div class="revealed-code" id="revealed-code" aria-label="Revealed secret code"></div>
        <button id="share-btn" type="button">Share</button>
        <div id="share-fallback" class="share-fallback hidden">
          <label class="sr-only" for="share-fallback-text">Share text</label>
          <textarea id="share-fallback-text" readonly></textarea>
        </div>
        <div class="action-stack horizontal">
          <button id="new-game-btn" type="button">New Game</button>
          <button id="new-match-code-btn" type="button" class="hidden">Generate New Match Code</button>
        </div>
      </div>
    </section>

    <script src="./script.js" defer></script>
  </body>
</html>
